(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/deliverGoods/deliverGoods"],{"2cb2":function(e,t,o){"use strict";o.r(t);var a=o("bf7b"),r=o.n(a);for(var n in a)"default"!==n&&function(e){o.d(t,e,function(){return a[e]})}(n);t["default"]=r.a},"3f4a":function(e,t,o){"use strict";o.r(t);var a=o("bc88"),r=o("2cb2");for(var n in r)"default"!==n&&function(e){o.d(t,e,function(){return r[e]})}(n);o("b799");var s=o("2877"),i=Object(s["a"])(r["default"],a["a"],a["b"],!1,null,null,null);t["default"]=i.exports},b6bc:function(e,t,o){},b799:function(e,t,o){"use strict";var a=o("b6bc"),r=o.n(a);r.a},bc88:function(e,t,o){"use strict";var a=function(){var e=this,t=e.$createElement,o=(e._self._c,Number(e.active)),a=Number(e.active);e._isMounted||(e.e0=function(t){e.active=0}),e.$mp.data=Object.assign({},{$root:{m0:o,m1:a}})},r=[];o.d(t,"a",function(){return a}),o.d(t,"b",function(){return r})},bf7b:function(e,t,o){"use strict";(function(e,a){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){return o.e("components/scodeError").then(o.bind(null,"94bf"))},n={components:{error:r},data:function(){return{sellerNameSelect:!1,userNameSelect:!1,type:"scanCode",text:"扫码错误",showError:!1,current:0,codeArr:[],arr:["中国","美国","巴西","日本"],index:0,active:0,List:[],count:0,flag:"",orSearch:!1,activity:"",otherMerchant:{tracePointName:"",personInCharge:""},info:{},contactNumber:""}},watch:{codeArr:{handler:function(e){var t=0,o=!0,a=!1,r=void 0;try{for(var n,s=this.codeArr[Symbol.iterator]();!(o=(n=s.next()).done);o=!0){var i=n.value;t+=i.count}}catch(c){a=!0,r=c}finally{try{o||null==s.return||s.return()}finally{if(a)throw r}}this.count=t},deep:!0},contactNumber:function(t){1===this.current&&(console.log(e(t," at pages\\deliverGoods\\deliverGoods.vue:113")),t.length>10&&t&&this.getMoblieUserMess())}},methods:{onShow:function(){var e=plus.android.runtimeMainActivity();this.activity=e;plus.android.importClass("android.content.Context");var t=plus.android.implements("io.dcloud.feature.internal.reflect.BroadcastReceiver",{onReceive:n});this.flag=t;var o=plus.android.importClass("android.content.IntentFilter"),a=(plus.android.importClass("android.content.Intent"),new o);a.addAction("android.intent.ACTION_DECODE_DATA"),e.registerReceiver(t,a);var r=this;function n(e,t){plus.android.importClass(t);var o=t.getByteArrayExtra("barcode"),a=s(o),n=(t.getIntExtra("length",0),t.getByteExtra("barcodeType",0));s(n);if(a&&a.indexOf(r.$common.host_name)>-1){var i=a.split(r.$common.host_name)[1];r.getzsCodeMumber(i)}else r.showError=!0,r.text="关联子码获取失败",r.type="scanCode"}function s(e){if("string"===typeof e)return e;for(var t="",o=e,a=0;a<o.length;a++){var r=o[a].toString(2),n=r.match(/^1+?(?=0)/);if(n&&8==r.length){for(var s=n[0].length,i=o[a].toString(2).slice(7-s),c=1;c<s;c++)i+=o[c+a].toString(2).slice(2);t+=String.fromCharCode(parseInt(i,2)),a+=s-1}else t+=String.fromCharCode(o[a])}return t}},destroyed:function(){this.activity.unregisterReceiver(this.flag)},onHide:function(){this.activity.unregisterReceiver(this.flag)},onUnload:function(){this.activity.unregisterReceiver(this.flag)},getMoblieUserMess:function(){var t=this;a.showLoading({mask:!0,title:"正在检索..."}),this.$common.getNot("/trace-api/other/getNodeByMobile?mobile="+this.contactNumber).then(function(o){console.log(e(typeof o.data.data," at pages\\deliverGoods\\deliverGoods.vue:227")),200===o.data.code?("number"===typeof o.data.data?(t.otherMerchant={tracePointName:"",personInCharge:""},t.sellerNameSelect=!1,t.userNameSelect=!1,t.orSearch=!1,t.$common.showToast("暂无信息","none")):(t.info=o.data.data,t.otherMerchant={tracePointName:o.data.data.tracePointName,personInCharge:o.data.data.personInCharge},t.orSearch=!0,t.contactNumber=o.data.data.contactNumber,t.sellerNameSelect=!0,t.userNameSelect=!0),console.log(e(t.otherMerchant," at pages\\deliverGoods\\deliverGoods.vue:250"))):t.$common.showToast("信息获取失败","none")})},radioChange:function(t){console.log(e(t.detail.value," at pages\\deliverGoods\\deliverGoods.vue:257")),this.current=Number(t.detail.value),console.log(e(1===this.current," at pages\\deliverGoods\\deliverGoods.vue:259")),1===this.current?this.contactNumber="":(this.contactNumber=this.List[this.index].mobile,this.getMoblieUserMess()),this.otherMerchant={tracePointName:"",personInCharge:""},console.log(e(this.current," at pages\\deliverGoods\\deliverGoods.vue:271"))},getzsCodeMumber:function(t){var o=this,a=this;this.$common.get("/trace-api/other/isCurrentNodeNewest?sid="+t).then(function(r){200===r.data.code?r.data.data?o.$common.get("/trace-api/trace/getSubCodeById?sid="+t).then(function(t){if(200===Number(t.data.code)){if(console.log(e("发货对象",t," at pages\\deliverGoods\\deliverGoods.vue:282")),a.showError=!1,Number(t.data.data.isEnable)>0)if(a.codeArr.length>0){var o=[],r=!0,n=!1,s=void 0;try{for(var i,c=a.codeArr[Symbol.iterator]();!(r=(i=c.next()).done);r=!0){var d=i.value;o.push(d.traceSubCodeNumber)}}catch(u){n=!0,s=u}finally{try{r||null==c.return||c.return()}finally{if(n)throw s}}o.indexOf(t.data.data.traceSubCodeNumber)>-1?a.$common.showToast("子码编号已存在","none"):(a.$common.showToast("扫码成功","success"),a.codeArr.push({traceSid:t.data.data.traceSid,count:t.data.data.count,traceSubCodeNumber:t.data.data.traceSubCodeNumber})),console.log(e(o," at pages\\deliverGoods\\deliverGoods.vue:300"))}else a.$common.showToast("扫码成功","success"),a.codeArr.push({traceSid:t.data.data.traceSid,count:t.data.data.count,traceSubCodeNumber:t.data.data.traceSubCodeNumber});else a.$common.showToast("此编码已发货","none");console.log(e(a.codeArr," at pages\\deliverGoods\\deliverGoods.vue:314"))}else a.showError=!1,a.$common.showToast(t.data.message,"none")}):a.$common.showToast("不属于该追溯码最新的流通节点","none"):a.$common.showToast(r.data.message,"none")})},next:function(){this.codeArr.length>0?this.active=1:this.$common.showToast("请添加货物","none")},nextConfirm:function(){var t=this;if(0!==this.codeArr.length){this.otherMerchant.contactNumber=this.contactNumber;var o=[],r=!0,n=!1,s=void 0;try{for(var i,c=this.codeArr[Symbol.iterator]();!(r=(i=c.next()).done);r=!0){var d=i.value;o.push(d.traceSubCodeNumber)}}catch(v){n=!0,s=v}finally{try{r||null==c.return||c.return()}finally{if(n)throw s}}for(var u={codeNumber:o,accountId:this.orSearch?this.info.accountId:-1,otherMerchant:this.otherMerchant,mode:2},l=Object.values(this.otherMerchant),h=0;h<l.length;h++){var m=l[h];if(!m)return this.$common.showToast("节点信息需填写完整","none"),!1}console.log(e(u," at pages\\deliverGoods\\deliverGoods.vue:360")),this.$common.post("/trace-api/trace/deliverGoods",u).then(function(o){console.log(e(o," at pages\\deliverGoods\\deliverGoods.vue:364")),200===Number(o.data.code)?(t.$common.showToast(o.data.message,"success"),setTimeout(function(){a.navigateBack({delta:1})},1500)):t.$common.showToast(o.data.message,"none")})}else this.$common.showToast("外码或内码不能为空","none")},getList:function(){var t=this,o=a.getStorageSync("setUserData").merchant.merchantId;this.$common.get("/agent/merchantAgent/normal?merchantId="+o).then(function(o){console.log(e(o," at pages\\deliverGoods\\deliverGoods.vue:380")),t.List=o.data.data||[],t.getOneData()})},getOneData:function(){0===this.current&&this.List.length>0&&(this.contactNumber=this.List[0].mobile,this.getMoblieUserMess())},bindPickerChange:function(t){0===this.current&&(console.log(e(Number(t.target.value)," at pages\\deliverGoods\\deliverGoods.vue:400")),this.List[Number(t.target.value)]&&this.List[Number(t.target.value)].mobile&&(this.contactNumber=this.List[Number(t.target.value)].mobile,this.getMoblieUserMess())),this.index=Number(t.target.value)},jump:function(){this.active=1},deleteCode:function(e){var t=this;a.showModal({title:"提示",content:"此操作将删除此编号",success:function(o){o.confirm&&(t.codeArr.splice(e,1),t.$common.showToast("删除成功","success"))}})},scanCode:function(){var t=this;a.scanCode({success:function(o){var a=t;if(o.result&&o.result.indexOf(a.$common.host_name)>-1){var r=o.result.split(a.$common.host_name)[1];console.log(e("sid",r," at pages\\deliverGoods\\deliverGoods.vue:434")),t.$common.get("/trace-api/other/isCurrentNodeNewest?sid="+r).then(function(o){console.log(e(o," at pages\\deliverGoods\\deliverGoods.vue:437")),200===o.data.code?o.data.data?t.$common.get("/trace-api/trace/getSubCodeById?sid="+r).then(function(t){if(200===Number(t.data.code)){if(console.log(e("发货对象",t," at pages\\deliverGoods\\deliverGoods.vue:442")),a.showError=!1,Number(t.data.data.isEnable)>0)if(a.codeArr.length>0){var o=[],r=!0,n=!1,s=void 0;try{for(var i,c=a.codeArr[Symbol.iterator]();!(r=(i=c.next()).done);r=!0){var d=i.value;o.push(d.traceSubCodeNumber)}}catch(u){n=!0,s=u}finally{try{r||null==c.return||c.return()}finally{if(n)throw s}}o.indexOf(t.data.data.traceSubCodeNumber)>-1?a.$common.showToast("子码编号已存在","none"):(a.$common.showToast("扫码成功","success"),a.codeArr.push({traceSid:t.data.data.traceSid,count:t.data.data.count,traceSubCodeNumber:t.data.data.traceSubCodeNumber})),console.log(e(o," at pages\\deliverGoods\\deliverGoods.vue:460"))}else a.$common.showToast("扫码成功","success"),a.codeArr.push({traceSid:t.data.data.traceSid,count:t.data.data.count,traceSubCodeNumber:t.data.data.traceSubCodeNumber});else a.$common.showToast("此编码已发货","none");console.log(e(a.codeArr," at pages\\deliverGoods\\deliverGoods.vue:474"))}else a.showError=!1,a.$common.showToast(t.data.message,"none")}):a.$common.showToast("不属于该追溯码最新的流通节点","none"):a.$common.showToast(o.data.message,"none")})}else t.showError=!0,t.text="关联子码获取失败",t.type="scanCode"}})}},onReady:function(){this.getList()}};t.default=n}).call(this,o("0de9")["default"],o("6e42")["default"])},ee9c:function(e,t,o){"use strict";(function(e){o("7b83"),o("921b");a(o("66fd"));var t=a(o("3f4a"));function a(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,o("6e42")["createPage"])}},[["ee9c","common/runtime","common/vendor"]]]);