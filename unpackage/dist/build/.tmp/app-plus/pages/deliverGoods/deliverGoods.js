(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/deliverGoods/deliverGoods"],{"0a94":function(e,t,o){"use strict";var a=function(){var e=this,t=e.$createElement,o=(e._self._c,Number(e.active)),a=Number(e.active);e._isMounted||(e.e0=function(t){e.active=0}),e.$mp.data=Object.assign({},{$root:{m0:o,m1:a}})},r=[];o.d(t,"a",function(){return a}),o.d(t,"b",function(){return r})},"2cb2":function(e,t,o){"use strict";o.r(t);var a=o("bf7b"),r=o.n(a);for(var n in a)"default"!==n&&function(e){o.d(t,e,function(){return a[e]})}(n);t["default"]=r.a},"3f4a":function(e,t,o){"use strict";o.r(t);var a=o("0a94"),r=o("2cb2");for(var n in r)"default"!==n&&function(e){o.d(t,e,function(){return r[e]})}(n);o("b799");var s=o("2877"),i=Object(s["a"])(r["default"],a["a"],a["b"],!1,null,null,null);t["default"]=i.exports},b6bc:function(e,t,o){},b799:function(e,t,o){"use strict";var a=o("b6bc"),r=o.n(a);r.a},bf7b:function(e,t,o){"use strict";(function(e,a){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){return o.e("components/scodeError").then(o.bind(null,"94bf"))},n={components:{error:r},data:function(){return{sellerNameSelect:!1,userNameSelect:!1,type:"scanCode",text:"扫码错误",showError:!1,current:0,codeArr:[],arr:["中国","美国","巴西","日本"],index:0,active:0,List:[],count:0,flag:"",orSearch:!1,activity:"",otherMerchant:{tracePointName:"",personInCharge:""},info:{},contactNumber:""}},watch:{codeArr:{handler:function(e){var t=0,o=!0,a=!1,r=void 0;try{for(var n,s=this.codeArr[Symbol.iterator]();!(o=(n=s.next()).done);o=!0){var i=n.value;t+=i.count}}catch(c){a=!0,r=c}finally{try{o||null==s.return||s.return()}finally{if(a)throw r}}this.count=t},deep:!0},contactNumber:function(e){1===this.current&&e&&this.getMoblieUserMess()}},methods:{onShow:function(){var e=plus.android.runtimeMainActivity();this.activity=e;plus.android.importClass("android.content.Context");var t=plus.android.implements("io.dcloud.feature.internal.reflect.BroadcastReceiver",{onReceive:n});this.flag=t;var o=plus.android.importClass("android.content.IntentFilter"),a=(plus.android.importClass("android.content.Intent"),new o);a.addAction("android.intent.ACTION_DECODE_DATA"),e.registerReceiver(t,a);var r=this;function n(e,t){plus.android.importClass(t);var o=t.getByteArrayExtra("barcode"),a=s(o),n=(t.getIntExtra("length",0),t.getByteExtra("barcodeType",0));s(n);if(a&&a.indexOf(r.$common.host_name)>-1){var i=a.split(r.$common.host_name)[1];r.getzsCodeMumber(i)}else r.showError=!0,r.text="关联子码获取失败",r.type="scanCode"}function s(e){if("string"===typeof e)return e;for(var t="",o=e,a=0;a<o.length;a++){var r=o[a].toString(2),n=r.match(/^1+?(?=0)/);if(n&&8==r.length){for(var s=n[0].length,i=o[a].toString(2).slice(7-s),c=1;c<s;c++)i+=o[c+a].toString(2).slice(2);t+=String.fromCharCode(parseInt(i,2)),a+=s-1}else t+=String.fromCharCode(o[a])}return t}},destroyed:function(){this.activity.unregisterReceiver(this.flag)},onHide:function(){this.activity.unregisterReceiver(this.flag)},onUnload:function(){this.activity.unregisterReceiver(this.flag)},getMoblieUserMess:function(){var t=this;e.showLoading({mask:!0,title:"正在检索..."}),this.$common.getNot("/trace-api/other/getNodeByMobile?mobile="+this.contactNumber).then(function(e){console.log(a(typeof e.data.data," at pages\\deliverGoods\\deliverGoods.vue:222")),200===e.data.code?("number"===typeof e.data.data?(t.otherMerchant={tracePointName:"",personInCharge:""},t.sellerNameSelect=!1,t.userNameSelect=!1,t.orSearch=!1,t.$common.showToast("暂无信息","none")):(t.info=e.data.data,t.otherMerchant={tracePointName:e.data.data.tracePointName,personInCharge:e.data.data.personInCharge},t.orSearch=!0,t.contactNumber=e.data.data.contactNumber,t.sellerNameSelect=!0,t.userNameSelect=!0),console.log(a(t.otherMerchant," at pages\\deliverGoods\\deliverGoods.vue:245"))):t.$common.showToast("信息获取失败","none")})},radioChange:function(e){console.log(a(e.detail.value," at pages\\deliverGoods\\deliverGoods.vue:252")),this.current=Number(e.detail.value),console.log(a(1===this.current," at pages\\deliverGoods\\deliverGoods.vue:254")),1===this.current?this.contactNumber="":(this.contactNumber=this.List[this.index].mobile,this.getMoblieUserMess()),this.otherMerchant={tracePointName:"",personInCharge:""},console.log(a(this.current," at pages\\deliverGoods\\deliverGoods.vue:266"))},getzsCodeMumber:function(e){var t=this,o=this;this.$common.get("/trace-api/other/isCurrentNodeNewest?sid="+e).then(function(r){200===r.data.code?r.data.data?t.$common.get("/trace-api/trace/getSubCodeById?sid="+e).then(function(e){if(200===Number(e.data.code)){if(console.log(a("发货对象",e," at pages\\deliverGoods\\deliverGoods.vue:277")),o.showError=!1,Number(e.data.data.isEnable)>0)if(o.codeArr.length>0){var t=[],r=!0,n=!1,s=void 0;try{for(var i,c=o.codeArr[Symbol.iterator]();!(r=(i=c.next()).done);r=!0){var d=i.value;t.push(d.traceSubCodeNumber)}}catch(u){n=!0,s=u}finally{try{r||null==c.return||c.return()}finally{if(n)throw s}}t.indexOf(e.data.data.traceSubCodeNumber)>-1?o.$common.showToast("子码编号已存在","none"):(o.$common.showToast("扫码成功","success"),o.codeArr.push({traceSid:e.data.data.traceSid,count:e.data.data.count,traceSubCodeNumber:e.data.data.traceSubCodeNumber})),console.log(a(t," at pages\\deliverGoods\\deliverGoods.vue:295"))}else o.$common.showToast("扫码成功","success"),o.codeArr.push({traceSid:e.data.data.traceSid,count:e.data.data.count,traceSubCodeNumber:e.data.data.traceSubCodeNumber});else o.$common.showToast("此编码已发货","none");console.log(a(o.codeArr," at pages\\deliverGoods\\deliverGoods.vue:309"))}else o.showError=!1,o.$common.showToast(e.data.message,"none")}):o.$common.showToast("不属于该追溯码最新的流通节点","none"):o.$common.showToast(r.data.message,"none")})},next:function(){this.codeArr.length>0?this.active=1:this.$common.showToast("请添加货物","none")},nextConfirm:function(){var t=this;if(0!==this.codeArr.length){this.otherMerchant.contactNumber=this.contactNumber;var o=[],r=!0,n=!1,s=void 0;try{for(var i,c=this.codeArr[Symbol.iterator]();!(r=(i=c.next()).done);r=!0){var d=i.value;o.push(d.traceSubCodeNumber)}}catch(v){n=!0,s=v}finally{try{r||null==c.return||c.return()}finally{if(n)throw s}}for(var u={codeNumber:o,accountId:this.orSearch?this.info.accountId:-1,otherMerchant:this.otherMerchant,mode:0===this.current?1:2},l=Object.values(this.otherMerchant),h=0;h<l.length;h++){var m=l[h];if(!m)return this.$common.showToast("节点信息需填写完整","none"),!1}console.log(a(u," at pages\\deliverGoods\\deliverGoods.vue:355")),this.$common.post("/trace-api/trace/deliverGoods",u).then(function(o){console.log(a(o," at pages\\deliverGoods\\deliverGoods.vue:359")),200===Number(o.data.code)?(t.$common.showToast(o.data.message,"success"),setTimeout(function(){e.navigateBack({delta:1})},1500)):t.$common.showToast(o.data.message,"none")})}else this.$common.showToast("外码或内码不能为空","none")},getList:function(){var t=this,o=e.getStorageSync("setUserData").merchant.merchantId;this.$common.get("/agent/merchantAgent/normal?merchantId="+o).then(function(e){console.log(a(e," at pages\\deliverGoods\\deliverGoods.vue:375")),t.List=e.data.data||[],t.getOneData()})},getOneData:function(){0===this.current&&this.List.length>0&&(this.contactNumber=this.List[0].mobile,this.getMoblieUserMess())},bindPickerChange:function(e){0===this.current&&(console.log(a(Number(e.target.value)," at pages\\deliverGoods\\deliverGoods.vue:395")),this.List[Number(e.target.value)]&&this.List[Number(e.target.value)].mobile&&(this.contactNumber=this.List[Number(e.target.value)].mobile,this.getMoblieUserMess())),this.index=Number(e.target.value)},jump:function(){this.active=1},deleteCode:function(t){var o=this;e.showModal({title:"提示",content:"此操作将删除此编号",success:function(e){e.confirm&&(o.codeArr.splice(t,1),o.$common.showToast("删除成功","success"))}})},scanCode:function(){var t=this;e.scanCode({success:function(e){var o=t;if(e.result&&e.result.indexOf(o.$common.host_name)>-1){var r=e.result.split(o.$common.host_name)[1];console.log(a("sid",r," at pages\\deliverGoods\\deliverGoods.vue:429")),t.$common.get("/trace-api/other/isCurrentNodeNewest?sid="+r).then(function(e){console.log(a(e," at pages\\deliverGoods\\deliverGoods.vue:432")),200===e.data.code?e.data.data?t.$common.get("/trace-api/trace/getSubCodeById?sid="+r).then(function(e){if(200===Number(e.data.code)){if(console.log(a("发货对象",e," at pages\\deliverGoods\\deliverGoods.vue:437")),o.showError=!1,Number(e.data.data.isEnable)>0)if(o.codeArr.length>0){var t=[],r=!0,n=!1,s=void 0;try{for(var i,c=o.codeArr[Symbol.iterator]();!(r=(i=c.next()).done);r=!0){var d=i.value;t.push(d.traceSubCodeNumber)}}catch(u){n=!0,s=u}finally{try{r||null==c.return||c.return()}finally{if(n)throw s}}t.indexOf(e.data.data.traceSubCodeNumber)>-1?o.$common.showToast("子码编号已存在","none"):(o.$common.showToast("扫码成功","success"),o.codeArr.push({traceSid:e.data.data.traceSid,count:e.data.data.count,traceSubCodeNumber:e.data.data.traceSubCodeNumber})),console.log(a(t," at pages\\deliverGoods\\deliverGoods.vue:455"))}else o.$common.showToast("扫码成功","success"),o.codeArr.push({traceSid:e.data.data.traceSid,count:e.data.data.count,traceSubCodeNumber:e.data.data.traceSubCodeNumber});else o.$common.showToast("此编码已发货","none");console.log(a(o.codeArr," at pages\\deliverGoods\\deliverGoods.vue:469"))}else o.showError=!1,o.$common.showToast(e.data.message,"none")}):o.$common.showToast("不属于该追溯码最新的流通节点","none"):o.$common.showToast(e.data.message,"none")})}else t.showError=!0,t.text="关联子码获取失败",t.type="scanCode"}})}},created:function(){this.getList()}};t.default=n}).call(this,o("6e42")["default"],o("0de9")["default"])},ee9c:function(e,t,o){"use strict";(function(e){o("7b83"),o("921b");a(o("66fd"));var t=a(o("3f4a"));function a(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,o("6e42")["createPage"])}},[["ee9c","common/runtime","common/vendor"]]]);